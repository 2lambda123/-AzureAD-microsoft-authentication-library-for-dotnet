# template-run-integration-tests.yaml
# Run all integration tests across the LibsAndSamples.sln project

parameters:
  BuildConfiguration: 'debug'

steps:
- task: VSTest@2
  displayName: 'Run Integration Tests - net45'
  continueOnError: true
  inputs:
    testSelector: 'testAssemblies'
    testAssemblyVer2: |      
        !**\obj\**
        **\tests\**\Microsoft.Identity.Test.Integration.net45.dll
    searchFolder: '$(System.DefaultWorkingDirectory)'
    codeCoverageEnabled: false
    failOnMinTestsNotRun: true
    minimumExpectedTests: 44
    rerunFailedTests: true
    rerunMaxAttempts: 1
    otherConsoleOptions: '/platform:x64 /Framework:.NETFramework,Version=v4.6 /logger:console;verbosity="normal" '

- task: VSTest@2
  displayName: 'Run Integration Tests - netcore'
  continueOnError: true
  inputs:
    testSelector: 'testAssemblies'
    testAssemblyVer2: |      
        !**\obj\**
        **\tests\**\Microsoft.Identity.Test.Integration.netcore.dll
    searchFolder: '$(System.DefaultWorkingDirectory)'
    codeCoverageEnabled: false
    failOnMinTestsNotRun: true
    minimumExpectedTests: 36
    rerunFailedTests: true
    rerunMaxAttempts: 1
    otherConsoleOptions: '/platform:x64 /Framework:.NETCoreApp,Version=v2.1 /logger:console;verbosity="normal" '
