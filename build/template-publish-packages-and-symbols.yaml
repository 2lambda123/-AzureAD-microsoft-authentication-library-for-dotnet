# template-publish-packages-and-symbols.yaml
# Publishes all nuget packages and symbols to appropriate destinations.

parameters:
  NugetPackagesWildcard: '$(Build.ArtifactStagingDirectory)\packages\*.nupkg'
  ArtifactPublishPath: '$(Build.ArtifactStagingDirectory)\packages'

steps:
- task: NuGetCommand@2
  displayName: 'Verify packages are signed'
  inputs:
    command: custom
    arguments: 'verify -Signature ${{ parameters.NugetPackagesWildcard }}'
  continueOnError: true

- task: AzureArtifacts.manifest-generator-task.manifest-generator-task.ManifestGeneratorTask@0
  displayName: 'Get Software Bill Of Materials (SBOM)'
  inputs:
       BuildDropPath: '${{ parameters.ArtifactPublishPath }}'
